<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
    <title>Bathrooms NYC</title>
    <link href="Content/Style.css" rel="stylesheet" />
    <link rel="stylesheet" href="Content/flexboxgrid.min.css" type="text/css">
    <link href="Content/angular-material.min.css" rel="stylesheet" />
    <script src="Scripts/packages/angular/angular.min.js"></script>
    <script src="Scripts/packages/angular-animate/angular-animate.min.js"></script>
    <script src="Scripts/packages/angular-aria/angular-aria.min.js"></script>
    <script src="Scripts/packages/angular-messages/angular-messages.min.js"></script>
    <script src="Scripts/packages/angular-material/angular-material.min.js"></script>
    <script src="Scripts/packages/angular/ng-map.min.js"></script>
	<script src="Scripts/packages/angular/heatmap-layer.js"></script>
</head>
<body ng-app="BathroomsNYCApp" ng-cloak>
    <div ng-controller="progressController">
        <div class="shield" ng-show="shield()" ng-animate="'animate'"></div>
        <div id="progress" ng-show="progress()" class="loader" ng-animate="'animate'">
            <md-progress-linear md-mode="indeterminate"></md-progress-linear>
        </div>
    </div>
    <div ng-controller="markersController">
        <div map-lazy-load="https://maps.google.com/maps/api/js?key=AIzaSyBu9juBXdxKCdLOpsJSgKzcvrk-hudIaS4&libraries=visualization">
            <ul class="flex-container">
                <li class="flex-item-map">
                    <ng-map class="map" center="{{location.latitude}}, {{location.longitude}}" zoom="{{zoom}}">
                        
                        <custom-control id="home" position="TOP_RIGHT" index="1">
                            <md-input-container flex-gt-sm class="md-block" style="width: 150px">
                                <md-icon md-svg-src="Content/img/icons/locations.svg"></md-icon>
                                <label>Bathrooms Around</label>
                                <input ng-model = "amountBathrooms" ng-keyup = "$event.keyCode == 13 ? getMarkers(location, amountBathrooms) : null">
                            </md-input-container>
                        </custom-control>

                        <custom-control  position="TOP_LEFT" index="2">
                            <button id="heatMapButton" ng-click="toggleHeatmap()">Heatmap</button>
                        </custom-control>

                        <custom-control position="BOTTOM_LEFT" index="3">
                            <button id="myLocationButton" ng-click="getCenter()" aria-label="My Location">
                                <md-icon md-svg-icon="Content/img/icons/my_location.svg" style = "margin-left: -3px; width: 20px; height: 5px;"></md-icon>
                            </button>
                        </custom-control>
                        
                        <custom-control position="TOP_LEFT" index="4">
                            <button id="boundingBoxButton" ng-click="toggleBoundingBox()">Bounding Box</button>
                        </custom-control>

                        <marker id="location" position="{{location.latitude}}, {{location.longitude}}" on-mouseup="markerMove()" draggable="true" icon="Content/img/icons/my_location.png" ng-cloak/>
                        
                        <div ng-repeat="marker in markers">
                            <marker position="[{{marker.latitude}}, {{marker.longitude}}]" on-click="showWindow(event, marker)" ng-cloak/>
                        </div>
                        
                        <info-window id="info">
                            <div class="vertical-container" ng-non-bindable>
                                <md-card>
                                    <img ng-src="{{activeMarker.image}}" class="md-card-image">
                                    <md-card-title>
                                        <md-card-title-text>
                                            <span class="md-headline">{{activeMarker.name}}</span>
                                            <span class="md-subhead">{{activeMarker.location}}</span>
                                        </md-card-title-text>
                                    </md-card-title>
                                    <md-card-content>
                                        <p>
                                            Open Year-Round: {{activeMarker.openYearRound}} <br>
                                            Handicap Access: {{activeMarker.handicap}} <br>
                                            Comments: {{activeMarker.comments}}
                                        </p>
                                    </md-card-content>
                                    <md-card-actions layout="row" layout-align="end center">
                                        rating: {{activeMarker.rating}}
                                        <md-button class="md-icon-button" ng-click="rateBathroom(activeMarker.id)" aria-label="Like">
                                            <md-icon md-svg-icon="Content/img/icons/favorite.svg"></md-icon>
                                        </md-button>
                                        <md-button class="md-icon-button" ng-click="getDirections()" aria-label="Directions">
                                            <md-icon md-svg-icon="Content/img/icons/directions.svg"></md-icon>
                                        </md-button>
                                    </md-card-actions>
                                </md-card>
                            </div>
                        </info-window>
                        
                        <directions draggable = "false"
                                    suppress-markers = "true"
                                    panel = "directions-panel"
                                    travel-mode = "WALKING"
                                    origin = "{{ location.latitude }}, {{ location.longitude }}"
                                    destination = "{{ destination.latitude }}, {{destination.longitude }}">
                        </directions>
                        
                        <heatmap-layer id = "heatmapLayer" data = "heatmapdata"></heatmap-layer>			
                        		
                        <shape name = "rectangle"
                               visible = "{{ isBoundingBoxMode }}"
                               editable = "true"
                               draggable = "true"
                               bounds="[[{{ boundingBox.northEastBound.latitude }},{{ boundingBox.northEastBound.longitude }}], [{{ boundingBox.southWestBound.latitude }}, {{ boundingBox.southWestBound.longitude }}]]"
                               on-mouseup = "boundsChanged()"> <!--on_resized event?-->
                        </shape>
                        	
                    </ng-map>
                </li>
                <li class="flex-item-directions">
                    <div id="directions-panel" />
                </li>
            </ul>
        </div>
    </div>

    <script src="Scripts/app.js"></script>
    <script src="Scripts/js/main.js"></script>
    <script src="Scripts/services/progressService.js"></script>
    <script src="Scripts/controllers/markersController.js"></script>
    <script src="Scripts/controllers/progressController.js"></script>
</body>
</html>
